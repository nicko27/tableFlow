# Plugin TextEditor

Ce plugin fournit un √©diteur de texte riche pour les cellules de TableFlow. Il offre une interface intuitive avec une barre d'outils compl√®te, des raccourcis clavier, et de nombreuses options de personnalisation.

## Table des mati√®res

1. [Fonctionnalit√©s](#fonctionnalit√©s)
2. [Installation](#installation)
3. [Configuration](#configuration)
4. [Utilisation](#utilisation)
5. [API](#api)
6. [Hooks](#hooks)
7. [√âv√©nements](#√©v√©nements)
8. [Styles](#styles)
9. [Accessibilit√©](#accessibilit√©)
10. [Raccourcis clavier](#raccourcis-clavier)
11. [Int√©gration](#int√©gration)
12. [Exemples](#exemples)
13. [D√©pannage](#d√©pannage)

## Fonctionnalit√©s

### √âdition de texte
- Formatage de texte (gras, italique, soulign√©, barr√©)
- Alignement du texte (gauche, centre, droite, justifi√©)
- Listes (√† puces et num√©rot√©es)
- Insertion et gestion de liens
- Couleurs de texte et de fond
- Annulation/r√©tablissement illimit√©

### Interface utilisateur
- Barre d'outils personnalisable
- Position de la barre d'outils configurable
- Dropdowns pour les options avanc√©es
- Palette de couleurs int√©gr√©e
- Indicateurs visuels d'√©tat

### Fonctionnalit√©s avanc√©es
- Auto-sauvegarde
- Limite de caract√®res
- Hauteur minimale et maximale
- Placeholder personnalisable
- Support du copier/coller
- Historique des modifications

### Int√©gration
- Compatible avec les autres plugins
- API compl√®te pour la personnalisation
- Hooks pour les √©v√©nements
- Styles enti√®rement personnalisables
- Support des th√®mes

## Installation

```javascript
import { TextEditorPlugin } from '@tableflow/plugins/texteditor';

const table = new TableFlow({
    plugins: {
        texteditor: {
            toolbar: {
                position: 'top',
                buttons: ['bold', 'italic', 'underline']
            }
        }
    }
});
```

## Configuration

### Options principales

```javascript
{
    // Classes CSS
    editorClass: 'tableflow-texteditor',
    activeClass: 'active',
    toolbarClass: 'tableflow-toolbar',
    buttonClass: 'tableflow-toolbar-button',
    dropdownClass: 'tableflow-toolbar-dropdown',
    separatorClass: 'tableflow-toolbar-separator',
    contentClass: 'tableflow-editor-content',
    placeholderClass: 'tableflow-editor-placeholder',
    
    // Configuration de l'√©diteur
    placeholder: 'Saisissez votre texte...',
    spellcheck: true,
    autofocus: true,
    maxLength: 1000,
    minHeight: '100px',
    maxHeight: '300px',
    
    // Options d'auto-sauvegarde
    autoSave: true,
    autoSaveInterval: 5000
}
```

### Configuration de la barre d'outils

```javascript
{
    toolbar: {
        position: 'top', // 'top' | 'bottom' | 'left' | 'right'
        sticky: true,
        buttons: {
            bold: {
                icon: 'ùêÅ',
                title: 'Gras',
                command: 'bold'
            },
            italic: {
                icon: 'ùë∞',
                title: 'Italique',
                command: 'italic'
            },
            // ... autres boutons
        }
    }
}
```

### Styles personnalisables

```javascript
{
    style: {
        // √âditeur
        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
        fontSize: '14px',
        lineHeight: '1.5',
        color: '#333333',
        background: '#ffffff',
        padding: '8px',
        borderRadius: '4px',
        border: '1px solid #e0e0e0',
        
        // ... autres styles
    }
}
```

## Utilisation

### Initialisation de base

```javascript
const table = new TableFlow({
    plugins: {
        texteditor: {
            autoSave: true,
            maxLength: 500
        }
    }
});
```

### Personnalisation de la barre d'outils

```javascript
const table = new TableFlow({
    plugins: {
        texteditor: {
            toolbar: {
                position: 'top',
                buttons: {
                    bold: true,
                    italic: true,
                    alignment: {
                        type: 'dropdown',
                        options: ['left', 'center', 'right']
                    }
                }
            }
        }
    }
});
```

### Gestion des √©v√©nements

```javascript
table.on('texteditor:change', (content) => {
    console.log('Contenu modifi√©:', content);
});

table.on('texteditor:save', (content) => {
    console.log('Contenu sauvegard√©:', content);
});
```

## API

### M√©thodes d'√©dition

- `startEdit(cell)`: D√©marre l'√©dition d'une cellule
- `stopEdit()`: Arr√™te l'√©dition
- `getContent()`: R√©cup√®re le contenu actuel
- `setContent(content)`: D√©finit le contenu
- `focus()`: Donne le focus √† l'√©diteur
- `blur()`: Retire le focus

### M√©thodes de formatage

- `execCommand(command, value)`: Ex√©cute une commande de formatage
- `queryCommandState(command)`: V√©rifie l'√©tat d'une commande
- `queryCommandValue(command)`: R√©cup√®re la valeur d'une commande
- `addFormat(format)`: Ajoute un format personnalis√©
- `removeFormat()`: Supprime tout le formatage

### M√©thodes d'historique

- `undo()`: Annule la derni√®re modification
- `redo()`: R√©tablit la derni√®re modification
- `clearHistory()`: Efface l'historique
- `canUndo()`: V√©rifie si une annulation est possible
- `canRedo()`: V√©rifie si un r√©tablissement est possible

## Hooks

### Avant l'√©dition
```javascript
table.hooks.register('beforeEdit', ({ cell, content }) => {
    // V√©rifier si l'√©dition est autoris√©e
    return true;
});
```

### Apr√®s l'√©dition
```javascript
table.hooks.register('afterEdit', ({ cell, content }) => {
    // Effectuer des actions apr√®s l'√©dition
});
```

### Avant la sauvegarde
```javascript
table.hooks.register('beforeSave', (content) => {
    // Valider ou transformer le contenu
    return content;
});
```

### Apr√®s la sauvegarde
```javascript
table.hooks.register('afterSave', (content) => {
    // Effectuer des actions apr√®s la sauvegarde
});
```

## √âv√©nements

### Changement de contenu
```javascript
table.on('texteditor:change', ({ content, source }) => {
    console.log('Contenu modifi√©:', content);
});
```

### Sauvegarde
```javascript
table.on('texteditor:save', ({ content, cell }) => {
    console.log('Contenu sauvegard√©:', content);
});
```

### Focus
```javascript
table.on('texteditor:focus', ({ cell }) => {
    console.log('√âditeur focalis√©');
});

table.on('texteditor:blur', ({ cell }) => {
    console.log('√âditeur non focalis√©');
});
```

## Styles

### Classes CSS
```css
.tableflow-texteditor { /* Conteneur principal */ }
.tableflow-toolbar { /* Barre d'outils */ }
.tableflow-toolbar-button { /* Boutons */ }
.tableflow-toolbar-dropdown { /* Menus d√©roulants */ }
.tableflow-editor-content { /* Zone d'√©dition */ }
```

### Variables CSS
```css
.tableflow-texteditor {
    --editor-font-family: -apple-system, system-ui, sans-serif;
    --editor-font-size: 14px;
    --editor-line-height: 1.5;
    --editor-color: #333333;
    --editor-background: #ffffff;
    --editor-border-color: #e0e0e0;
    --editor-border-radius: 4px;
    --editor-padding: 8px;
    
    --toolbar-background: #ffffff;
    --toolbar-border-color: #e0e0e0;
    --toolbar-shadow: 0 1px 3px rgba(0,0,0,0.1);
    
    --button-size: 32px;
    --button-color: #666666;
    --button-hover-color: #333333;
    --button-active-color: #2196F3;
}
```

## Accessibilit√©

### Attributs ARIA
- `role="textbox"` sur la zone d'√©dition
- `aria-label` sur les boutons de la barre d'outils
- `aria-pressed` sur les boutons √† bascule
- `aria-expanded` sur les menus d√©roulants
- `aria-describedby` pour les messages d'aide

### Navigation au clavier
- Tab : Navigation entre les boutons
- Entr√©e/Espace : Activation des boutons
- Fl√®ches : Navigation dans les menus
- √âchap : Fermeture des menus
- Mod+B/I/U : Raccourcis de formatage

## Raccourcis clavier

| Action | Raccourci |
|--------|-----------|
| Gras | Mod+B |
| Italique | Mod+I |
| Soulign√© | Mod+U |
| Lien | Mod+K |
| Annuler | Mod+Z |
| R√©tablir | Mod+Y |
| R√©tablir (alt) | Mod+Shift+Z |

## Int√©gration

### Avec le plugin Selection
```javascript
table.hooks.register('afterSelect', ({ cell }) => {
    if (cell.hasAttribute('data-editable')) {
        table.plugins.texteditor.startEdit(cell);
    }
});
```

### Avec le plugin ContextMenu
```javascript
table.plugins.contextMenu.registerProvider({
    getMenuItems: (cell) => [
        {
            id: 'edit',
            label: '√âditer',
            action: () => table.plugins.texteditor.startEdit(cell)
        }
    ]
});
```

## Exemples

### Configuration de base
```javascript
const table = new TableFlow({
    plugins: {
        texteditor: {
            autoSave: true,
            maxLength: 1000,
            toolbar: {
                position: 'top',
                buttons: ['bold', 'italic', 'underline']
            }
        }
    }
});
```

### Configuration avanc√©e
```javascript
const table = new TableFlow({
    plugins: {
        texteditor: {
            toolbar: {
                position: 'top',
                sticky: true,
                buttons: {
                    formatting: {
                        type: 'dropdown',
                        icon: 'T',
                        options: ['bold', 'italic', 'underline']
                    },
                    alignment: {
                        type: 'dropdown',
                        icon: '‚´è',
                        options: ['left', 'center', 'right']
                    },
                    color: {
                        type: 'color',
                        icon: 'A',
                        colors: ['#000', '#F00', '#0F0', '#00F']
                    }
                }
            },
            style: {
                fontFamily: 'Roboto, sans-serif',
                fontSize: '16px',
                toolbarBackground: '#f5f5f5'
            }
        }
    }
});
```

### Personnalisation des formats
```javascript
table.plugins.texteditor.addFormat({
    name: 'highlight',
    tag: 'mark',
    style: {
        backgroundColor: 'yellow'
    }
});
```

## D√©pannage

### Probl√®mes courants

1. **L'√©diteur ne s'affiche pas**
   - V√©rifier que le plugin est correctement initialis√©
   - V√©rifier que la cellule est √©ditable
   - V√©rifier la console pour les erreurs

2. **Les boutons ne fonctionnent pas**
   - V√©rifier que les commandes sont support√©es
   - V√©rifier que le focus est dans l'√©diteur
   - V√©rifier les permissions du navigateur

3. **L'auto-sauvegarde ne fonctionne pas**
   - V√©rifier que l'option est activ√©e
   - V√©rifier l'intervalle de sauvegarde
   - V√©rifier les hooks de sauvegarde

### Solutions

1. **R√©initialiser l'√©diteur**
```javascript
table.plugins.texteditor.destroy();
table.plugins.texteditor.init();
```

2. **Forcer la mise √† jour**
```javascript
table.plugins.texteditor.refresh();
```

3. **D√©boguer les √©v√©nements**
```javascript
table.on('texteditor:change', (data) => {
    console.log('Changement:', data);
});
``` 